{% extends 'base.html.twig' %}

{% block title %}Accueil{% endblock %}

{% block body %}
<style>
	.tableCSS {position : absolute; top : 35%; left : 25%; background-color: #e1ccc7;
border-collapse : collapse; text-align : center;}
	td {border : 1px #000000 solid; padding : 10px;}
	.tdTexte {color : #000000;}
	.tdDate {color : #000000;}
	.tdEntier {color : #000000;}

	 #addPatient{
	 padding : 1%;
	 background-color : white;
	 text-align : left;
	 position: absolute;
	 top: 40px; left: 25%;
   display: block;
	 visibility:hidden;
	 }

	 #addMatelas{
	 background-color : white;
	 text-align : left;
	 position: absolute;
	 top: 40px; left: 45%;
   display: block;
	 visibility:hidden;
	 }

	 #addMatelas{
	 background-color : white;
	 text-align : left;
	 position: absolute;
	 top: 200px; left: 40%;
	 display: block;
	 visibility:hidden;
	 }

	 .disconnectButton{
		 position: absolute;
    	top: -80px;
    	right: 65px;
			width: 8%;
			height: 5%;
	 }

	 .boutonAddPatient{
	 position: absolute;
	 top: 40px; left: 40px;
		padding:6px 0 6px 0;
		font:bold 13px Arial;
		background:#f5f5f5;
		color:#555;
		border-radius:2px;
		width:100px;
		border:1px solid #ccc;
		box-shadow:1px 1px 3px #999;
	}

	.boutonAddMatelas{
	position: absolute;
	top: 100px; left: 40px;
	padding:6px 0 6px 0;
	font:bold 13px Arial;
	background:#f5f5f5;
	color:#555;
	border-radius:2px;
	width:100px;
	border:1px solid #ccc;
	box-shadow:1px 1px 3px #999;
	}

	 .UserList{
		 margin-left : 15px;
		 font-family : "Arial";
		 font-size: 17px;
	 }
</style>
<div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>
var doStuff = function () {
	var u =$("#username").text();
	var d = new Date($("#lmodified").text());
	var startTime = new Date();
	var diff=startTime.getTime()-d.getTime();
	if(diff/1000>60*30){
			$(".disconnectButton").click();
	}

};
setInterval(doStuff, 1000);


</script>

{% for c in user %}

<div id="username" style="display:none">{{ c.getUsername() }}</div>
<div id="lmodified" style="display:none">{{c.getDate() }}</div>
{% endfor %}

	<table class = "tableCSS">
		<tr>
			<td class = "tdEntier">NIP</td>
			<td class = "tdDate">Premier scanner</td>
			<td class = "tdDate">MEP</td>
			<td class = "tdEntier">Nbr séance</td>
			<td class = "tdDate">FTR</td>
			<td class = "tdTexte">Commentaire</td>
			<td class = "tdEntier">N° matelas</td>
			<td class = "tdEntier">Type matelas</td>
		</tr>
		{% for c in customers %}
		<tr>
			<td class = "tdEntier">{{ c.getNip() }}</td>
			<td class = "tdDate">{{ c.getDateFirstScanner() }}</td>
			<td class = "tdDate">{{ c.getMep() }}</td>
			<td class = "tdEntier">{{ c.getNumberSeance() }}</td>
			<td class = "tdDate">{{ c.getFtr() }}</td>
			<td class = "tdTexte">{{ c.getComment() }}</td>
			<td class = "tdEntier">{{ c.getMattress() }}</td>
			<td class = "tdEntier">{{ c.getType() }}</td>
		</tr>
		{% endfor %}
	</table>

  <div id = "addPatient">
		{{ form_start(formulaireAddPatient) }}
		{{ form_widget(formulaireAddPatient) }}
		{{ form_end(formulaireAddPatient) }}
	</div>

	<form action =" {{path('home_page')}}" method ="post">
		<button class="disconnectButton" type="submit" name="disconnect">Déconnexion</button>
	</form>

	<div id = "addMatelas">
		{{ form_start(formulaireAddMatelas) }}
		{{ form_widget(formulaireAddMatelas) }}
		{{ form_end(formulaireAddMatelas) }}
	</div>

	<div class = "UserList">
	<b>Liste des utilisateurs connectés : {% for u in users %} {{ u.getUsername() }} <i>;</i> {% endfor %} </b>
	{{ form_start(formulaireAddMatelas) }}
	{{ form_widget(formulaireAddMatelas) }}
	{{ form_end(formulaireAddMatelas) }}
	</div>

</div>

<button class="boutonAddPatient" onclick="hideAddPatient()">
	Ajout d'un patient
</button>

<button class="boutonAddMatelas" onclick="hideAddMatelas()">
	Ajout d'un matelas
</button>

<script>
function hideAddPatient() {
	var elem = 	document.getElementById("addPatient");
	if(elem.style.visibility == "visible"){
		elem.style["visibility"] = "hidden";
	}else{
		elem.style["visibility"] = "visible";
	}
}

function hideAddMatelas() {
	var elem = 	document.getElementById("addMatelas");
	if(elem.style.visibility == "visible"){
		elem.style["visibility"] = "hidden";
	}else{
		elem.style["visibility"] = "visible";
	}
}
</script>



{% endblock %}
